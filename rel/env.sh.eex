#!/bin/sh

# Fly.io sets FLY_APP_NAME and FLY_ALLOC_ID
# We use these to set up Erlang distribution

ip=$(hostname -I | awk '{print $1}')
export RELEASE_DISTRIBUTION=name
export RELEASE_NODE="${FLY_APP_NAME}@${ip}"

# Generate a cookie if not set
if [ -z "$RELEASE_COOKIE" ]; then
  export RELEASE_COOKIE=$(cat /app/releases/COOKIE 2>/dev/null || echo "vfs-spike-cookie")
fi
